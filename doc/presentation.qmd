---
title: "Cold Stress Response in *Arabidopsis thaliana*"
author: "ATGenExpress Affymetrix Microarray Analysis"
format:
  revealjs: 
    theme: serif
    footer: "22160 - R for Bio Data Science"
    incremental: true
---

## Project Overview

<div style="font-size:0.65em;">

::: {.nonincremental}
- 01_load - *Import raw GEO series matrix files* 
- 02_clean - *Filter probes, remove controls, annotate genes*  
- 03_augment - *Integrate metadata, add averaged expression values*  
- 04_describe - *Summaries & key dataset visualization*  
- 05_analysis_1 - *Heatmap*  
- 05_analysis_2 - *Volcano plot*  
- 05_analysis_3 - *PCA plot*
- 05_analysis_4 - *Linear model using broom*
:::

---

## Background - *Arabidopsis thaliana*

:::: {.columns}

::: {.column width="60%"}
ATGen Project: cold stress transcriptomics with microarrays

<div style="text-align:center; text-decoration:underline;">
Dataset summary
</div>

::: {.incremental}
- 60 samples  
- 2 conditions  
- 2 tissues  
- 9 total timepoints  
- ~21k probes → ~10k after cleaning 
:::

:::

::: {.column width="40%"}


![](https://www.oxinst.com/learning/uploads/inline-images/a-thaliana-fig01-20190307164222.jpg){width="70%"}


:::

::::

---

## Step 01 - Load

### 1. Read raw GEO Series Matrix files

::: columns
::: column

``` r
raw_5620 <- readLines("../_raw/data/GSE5620_series_matrix.txt.gz")
raw_5621 <- readLines("../_raw/data/GSE5621_series_matrix.txt.gz")
```

:::

::: column
Read files line-by-line because they contain metadata and expression mixed together.
:::
:::

---

### 2. Extract metadata (titles + GSM IDs)

::: columns
::: column

``` r
extract_metadata <- function(raw_lines) {
  title_line <- raw_lines[str_detect(raw_lines, "^!Sample_title")]
  gsm_line   <- raw_lines[str_detect(raw_lines, "^!Sample_geo_accession")]

  title_clean <- str_remove(title_line, "^!Sample_title\t")
  gsm_clean   <- str_remove(gsm_line, "^!Sample_geo_accession\t")

  tibble(
    title = str_remove_all(title_clean, '"'),
    GSM   = str_remove_all(gsm_clean, '"')
  )
}
```

:::

::: column
Extract sample titles and GSM IDs from metadata lines.
:::
:::

---

### 3. Parse metadata into structured variables

::: columns
::: column

``` r
parse_title <- function(df) {
  df |>
    mutate(
      tissue    = str_extract(title, "(Shoots|Roots)"),
      timepoint = str_extract(title, "[0-9.]+h"),
      replicate = str_extract(title, "Rep[0-9]")
    )
}
```

:::

::: column
Extract tissue, timepoint, and replicate from sample titles.
:::
:::

---

### 4. Load numeric expression matrix

::: columns
::: column

``` r
gse5620 <- read.delim(file_5620, comment.char = "!", row.names = 1)
gse5621 <- read.delim(file_5621, comment.char = "!", row.names = 1)

expr_all <- cbind(gse5620, gse5621)
```

:::

::: column
Skip metadata with comment.char = "!" and load numeric matrix only.
:::
:::

---

### 5. Annotate probe IDs → gene symbols

::: columns
::: column

``` r
probe_to_gene <- AnnotationDbi::select(
  ath1121501.db,
  keys = rownames(expr_all),
  columns = c("PROBEID", "GENENAME", "SYMBOL"),
  keytype = "PROBEID"
)

expr_annotated <- left_join(
  clean_names(probe_to_gene),
  rownames_to_column(as.data.frame(expr_all), "probeid"),
  by = "probeid"
)
```

:::

::: column
Match probe IDs with gene symbols and gene names from ATH1 annotation.
:::
:::

---

## Step 02 - Clean  
(placeholder slide)

---

## Step 03 - Augment  
(placeholder slide)

---

## Step 04 - Describe  
(placeholder slide for your summary + plot)

---

## Step 05 - Heatmap  
(placeholder slide)

---

## Step 05 - Volcano Plot  
(placeholder slide)

---

## Step 05 - PCA Plot  
(placeholder slide)

---

## Step 05 - Linear Model (broom)  
(placeholder slide)

---

# Thank you! {footer=false}
